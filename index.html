<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoP Editor - Graph Interaction SDK</title>
    <!-- TW Script for dynamic prototyping -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            background: #f8fafc;
        }

        #app {
            height: 100vh;
            width: 100vw;
        }

        /* High Star UI Details */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>

<body>
    <!-- CRITICAL: ID must be 'app' to match Router.js -->
    <div id="app"></div>

    <!-- Import Map: Centralized Dependency Management -->
    <script type="importmap">
    {
        "imports": {
            "./AuthService.js": "./AuthService.js",
            "./MingdaoBaseService.js": "./MingdaoBaseService.js",
            "./config.js": "./config.js",
            
            "mop-viewport": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/ViewportEngine.js",
            "mop-renderer": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/CanvasRenderer.js",
            "mop-lane": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/LaneComponent.js",
            "mop-node": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/NodeComponent.js",
            "mop-edge": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/EdgeComponent.js",
            "mop-interaction-sdk": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/packages/mop-interaction-sdk/HitTest.js",
            "mop-drag-sdk": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/packages/mop-drag-sdk/NodeDragStrategy.js",
            "mop-gizmo-sdk": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/packages/mop-gizmo-sdk/GizmoRenderer.js",
            "mop-selection-strategy": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/packages/mop-gizmo-sdk/strategies/SelectionStrategy.js",
            "mop-editing-strategy": "https://cdn.jsdelivr.net/gh/santaalex/mop-elements@c6b4d2fc171ed8688c890d25fb4ea0bfdcc74572/packages/mop-gizmo-sdk/strategies/EditingStrategy.js"
        }
    }
    </script>

    <script type="module">
        import { Router } from './Router.js';
        import { LoginView } from './LoginView.js';
        import { DashboardView } from './DashboardView.js';
        import { EditorView } from './EditorView.js';
        import { ProjectService } from './ProjectService.js';

        // LOCAL IMPORT: Gizmo SDK (Patched)
        import { GizmoRenderer } from 'mop-gizmo-sdk';

        import { CanvasRenderer } from 'mop-renderer';
        import { InteractionManager } from './interactions/InteractionManager.js';
        import { ViewportEngine } from 'mop-viewport';
        import { LayoutConfig } from './LayoutConfig.js';

        // Critical: Import Atomic Components to register Custom Elements
        import "mop-viewport";
        import "mop-lane";
        import "mop-node";
        import "mop-edge";
        import "mop-renderer";

        // Initialize Router with View Instances
        const routes = {
            'login': new LoginView(),
            'dashboard': new DashboardView(),
            'editor': new EditorView()
        };

        // Root entry
        const router = new Router(routes);
        window.router = router; // Expose for interactions
    </script>
</body>

</html>